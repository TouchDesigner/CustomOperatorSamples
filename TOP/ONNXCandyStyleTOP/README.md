# ONNX Candy Style TOP
This example implements loading an ONNX based AI model using the [ONNX Runtime](https://onnxruntime.ai). It uses CUDA to execute the model.

## Prerequisites
* Requires TouchDesigner 2023.12308, due to the onnx-runtime.dll version bundled with the installer.
  * 2023.12308 is available [here](https://www.dropbox.com/scl/fi/zl5vdxi9eufdiocv2592v/TouchDesigner.2023.12308.exe?rlkey=92hvqbytiyybc9lye2xnfh2g4&dl=0).
  * We hope to find a more general solution to this issue in the near future.
* Requires an Nvidia GPU. Currently this example uses CUDA as the execution engine.
* It requires ONNX runtime version 1.18.1, for CUDA 11. Newer ONNX runtime releases are only for CUDA 12.
  * The project currently looks for the headers/libs for ONNX in C:/Program Files/onnxruntime
  * Download 1.18.1 runtime from the [ONNX Github](https://github.com/microsoft/onnxruntime/releases/download/v1.18.1/onnxruntime-win-x64-gpu-1.18.1.zip). Unzip them into C:/Program Files/onnxruntime so the directories C:/Program Files/onnxruntime/lib and C:/Program Files/onnxruntime/include exist with the .lib and .h files.
  * The .dll files from this are not used. The .dlls that come with TouchDesigner will be what is loaded.
* It requires the __candy.onnx__ model, which is available on the [ONNX Examples Github](https://github.com/microsoft/onnxruntime-inference-examples/tree/main/c_cxx/fns_candy_style_transfer). The model is directly available [here](https://raw.githubusercontent.com/microsoft/Windows-Machine-Learning/master/Samples/FNSCandyStyleTransfer/UWP/cs/Assets/candy.onnx).
  * Place __candy.onxx__ next to the .dll generated by this project that you load into the CPlsuPlus TOP (or your Plugins directory where you place the .dll).

This TOP takes one input which must be 8 bit RGBA, 720x270 resolution.
